<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obrigado pela Matrícula! - CED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
            text-align: center;
        }
        .thank-you-container {
            background-color: #2c2c2c;
            padding: 2rem 2.5rem; /* Aumentado padding */
            border-radius: 0.75rem; /* 12px */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 100%;
        }
        .icon-success {
            font-size: 4rem; /* 64px */
            color: #1DB954; /* Verde do botão de pagamento */
            margin-bottom: 1.5rem; /* 24px */
        }
        .status-message {
            font-size: 1.125rem; /* 18px */
            line-height: 1.75rem; /* 28px */
            color: #c0c0c0;
        }
        .highlight-text {
            color: #87CEEB; /* Um azul claro para destaque */
            font-weight: 600;
        }
        .footer-note {
            font-size: 0.875rem; /* 14px */
            color: #a0a0a0;
            margin-top: 2rem; /* 32px */
        }
        .button-platform { 
            display: inline-block;
            margin-top: 2rem; /* 32px */
            padding: 0.75rem 1.5rem; /* 12px 24px */
            background-color: #60a5fa; /* Azul claro */
            color: #1a1a1a;
            font-weight: 600;
            border-radius: 0.5rem; /* 8px */
            text-decoration: none;
            transition: background-color 0.3s ease;
        }
        .button-platform:hover { 
            background-color: #3b82f6; /* Azul um pouco mais escuro */
        }
    </style>
</head>
<body>
    <div class="thank-you-container">
        <i class="fas fa-check-circle icon-success"></i>
        <h1 class="text-3xl font-bold text-gray-100 mb-4">Pagamento efetuado com sucesso</h1>
        
        <p class="status-message mb-6">
            Obrigado por iniciar sua matrícula no CED! Recebemos sua solicitação de pagamento.
        </p>
        <p class="status-message mb-6">
            Seu pagamento está sendo processado pelo Mercado Pago. Você receberá um e-mail de confirmação assim que o status for atualizado.
            Isso pode levar alguns instantes.
        </p>
        <p class="status-message mb-2">
            Enquanto isso, você pode verificar o status da sua assinatura diretamente no seu painel do <span class="highlight-text">Mercado Pago</span>.
        </p>
        <p class="status-message">
            A <span class="highlight-text">confirmação final</span> da sua matrícula e o acesso ao curso serão enviados para o seu e-mail após a aprovação do pagamento.
        </p>

        <div id="paymentDetails" class="mt-6 text-sm text-gray-400">
            </div>
        
        <a href="https://ead.cedbrasilia.com.br" class="button-platform">
            Acessar Plataforma
        </a>

        <p class="footer-note">
            Se tiver alguma dúvida, entre em contato conosco.
        </p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const paymentDetailsDiv = document.getElementById('paymentDetails');
            let detailsHtml = '';

            // Parâmetros comuns que o Mercado Pago pode enviar para assinaturas (preapproval)
            const preapprovalId = params.get('preapproval_id'); // ID da assinatura no MP
            const externalReference = params.get('external_reference'); // Nosso ID interno
            const paymentId = params.get('payment_id'); // ID do primeiro pagamento (pode vir ou não)
            const status = params.get('status'); // Status geral (pode não ser o status final da assinatura)
            const collectionStatus = params.get('collection_status'); // Status da coleção (mais relevante para pagamentos únicos)


            if (preapprovalId) {
                detailsHtml += `<p>ID da Assinatura MP: <span class="font-semibold text-gray-300">${preapprovalId}</span></p>`;
            }
            if (externalReference) {
                detailsHtml += `<p>Referência Interna: <span class="font-semibold text-gray-300">${externalReference}</span></p>`;
            }
             if (paymentId) {
                detailsHtml += `<p>ID do Pagamento Inicial MP: <span class="font-semibold text-gray-300">${paymentId}</span></p>`;
            }
            if (status) { // Status geral da operação de redirect
                 detailsHtml += `<p>Status da Operação: <span class="font-semibold text-gray-300">${status}</span></p>`;
            }
             if (collectionStatus) { // Status da coleção (ex: approved, pending, rejected para o pagamento inicial)
                 detailsHtml += `<p>Status do Pagamento Inicial: <span class="font-semibold text-gray-300">${collectionStatus}</span></p>`;
            }


            if (detailsHtml) {
                paymentDetailsDiv.innerHTML = `<h2 class="text-lg font-semibold text-gray-200 mb-2">Detalhes da Transação:</h2>${detailsHtml}`;
            }

            const mainTitle = document.querySelector('.thank-you-container h1'); 
            const iconElement = document.querySelector('.icon-success');
            
            if (collectionStatus === 'approved') {
                // mainTitle.textContent = 'Pagamento Aprovado!'; // Linha comentada/removida para manter o título original
                 iconElement.classList.remove('fa-hourglass-half'); 
                 iconElement.classList.remove('fa-times-circle');
                 iconElement.classList.add('fa-check-circle'); 
                 iconElement.style.color = '#1DB954';
            } else if (collectionStatus === 'pending') {
                mainTitle.textContent = 'Pagamento Pendente!';
                iconElement.classList.remove('fa-check-circle');
                iconElement.classList.remove('fa-times-circle');
                iconElement.classList.add('fa-hourglass-half'); 
                iconElement.style.color = '#F59E0B'; 
            } else if (collectionStatus === 'rejected' || collectionStatus === 'cancelled' || collectionStatus === 'failed') {
                 mainTitle.textContent = 'Pagamento Não Aprovado';
                 iconElement.classList.remove('fa-check-circle');
                 iconElement.classList.remove('fa-hourglass-half');
                 iconElement.classList.add('fa-times-circle'); 
                 iconElement.style.color = '#EF4444'; 
            } else {
                 // Se collectionStatus não for 'approved', 'pending', ou um dos de falha,
                 // o título HTML original "Pagamento efetuado com sucesso" permanece.
                 iconElement.classList.remove('fa-hourglass-half'); 
                 iconElement.classList.remove('fa-times-circle');
                 iconElement.classList.add('fa-check-circle'); 
                 iconElement.style.color = '#1DB954'; 
            }
            console.log('Parâmetros da URL de retorno:', Object.fromEntries(params));
        });
    </script>
</body>
</html>
